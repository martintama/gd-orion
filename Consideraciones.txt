- Los giftcards no restan credito de quien lo regala
- Al migrar la base, se crean los clientes y proveedores. Luego, los usuarios se generan usando el DNI como username y CUIT en caso de proveedor
La clave inicial en ambos casos es la misma para todos, 123456.
- El nro de cupon es el PK de la tabla de cupones
- Fecha entrega = fecha consumo
- IMPORTENTE Recordar restar el stock de los cupones!! en base a restante = total - compras + devoluciones


Funcionalidades por defecto

Administrativos
. ABM de Cliente
. ABM de Proveedor
. ABM de Rol
. Facturación a Proveedores
. Publicar Cupón
. Listado Estadístico

Clientes
. Cargar Crédito
. Comprar Cupón
. Comprar GiftCard
. Historial de Compra de cupones
. Pedir Devolución

Proveedores
. Armar Cupón
. Registro de consumo de cupon

Accesible desde login:
. Registro de Usuario



 

Roles
- Proveedor
- Administrativo
- Cliente
- (Otros a gusto)

Tablas
-- cargas
-- ciudades
-- clientes
-- clientes_ciudades
-- compras
-- compras_estados
-- consumos
-- cupones
-- cupones_ciudades
-- devoluciones
-- facturas
-- facturas_items
-- funcionalidades
-- gift_cards
-- proveedores
-- roles
roles_funcionalidades
--rubros
-- tarjetas (Se carga a partir de la GUi)
-- tipos_pago
-- tipos_tarjeta
-- usuarios
-- usuarios_tipos



Estrategia:

Logueo.

Se ingresan el usuario y password. Se verifica si todos los datos están completos y se devueve un return_status el que puede ser:

0 - Todo OK: Logueo
1 - Usuario o password incorrecto
2 - Falta completar usuario o password
3 - Usuario baneado

General

Conexiones a la base se genera una nueva cada vez que se realiza una transaccion. Se utiliza una conexion global.

Roles

Suponemos que hay un usuario ya creado, el "administrador general", cuyo tipo de usuario
es "Administrativo" y posee el rol de "Administrador General".

A este rol, Administrador General, se le asignaron todas las funcionalidades

No se permite deshabilitar un rol que este asociado aún a un usuario. Esto se efectiviza
utilizando un stored procedure que devuelva un 0 si no hubo problemas, o un 1 si no se pudo
inhabilitar porque hay usuarios asociados.


Devoluciones
Los cupones devuefltos vuelven a figurar en el stock del cliente